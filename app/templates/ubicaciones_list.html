{% extends 'base.html' %} {% block title %}Ubicaciones · Patitas QR{% endblock
%} {% block content %}
<section class="list-page">
  <header class="list-header">
    <h2 class="list-title">Ubicaciones</h2>
  </header>

  {# ===== Nueva ubicación ===== #}
  <h3 class="section-title">Nueva ubicación</h3>
  <div class="card">
    <form
      method="post"
      action="{{ url_for('ubicaciones.crear_ubicacion') }}"
      class="form-grid form-inline"
    >
      <div class="field" style="min-width: 220px">
        <label for="comuna">Comuna *</label>
        <input id="comuna" name="comuna" required type="text" />
      </div>

      <div class="field" style="min-width: 220px">
        <label for="nombre_sector">Sector *</label>
        <input id="nombre_sector" name="nombre_sector" required type="text" />
      </div>

      <div class="field">
        <label for="descripcion">Descripción (opcional)</label>
        <input
          id="descripcion"
          name="descripcion"
          placeholder="Plaza, parque, estación, etc."
          type="text"
        />
      </div>

      <button type="submit" class="btn btn-primary btn-eq">Agregar</button>
    </form>
  </div>

  <h3 class="section-title">Ubicaciones registradas</h3>
  <form
    method="get"
    action="{{ url_for('ubicaciones.lista_ubicaciones') }}"
    class="toolbar"
  >
    <div class="searchbar">
      <label for="q" class="sr-only">Buscar</label>
      <input
        id="q"
        name="q"
        placeholder="Buscar por comuna, sector o descripción"
        value="{{ q or '' }}"
        autocomplete="off"
      />
    </div>
    <div class="toolbar-actions">
      <button
        type="submit"
        class="btn btn-primary btn-eq"
        style="margin-bottom: 10px"
      >
        Buscar
      </button>
      <a
        class="btn btn-outline btn-eq"
        href="{{ url_for('ubicaciones.lista_ubicaciones') }}"
        >Limpiar</a
      >
    </div>
  </form>

  {% if ubicaciones|length == 0 %}
  <div class="empty-state">
    <p>No hay ubicaciones registradas.</p>
  </div>
  {% else %}
  <div class="table-wrap">
    <table class="table table--list">
      <thead>
        <tr>
          <th class="id-column">ID</th>
          <th style="width: 180px">Comuna</th>
          <th style="width: 220px">Sector</th>
          <th>Descripción</th>
          <th style="width: 160px">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for u in ubicaciones %}
        <tr>
          <td>#{{ u.ubicacion_id }}</td>
          <td>{{ u.comuna }}</td>
          <td>{{ u.nombre_sector }}</td>
          <td>{{ u.descripcion or '—' }}</td>
          <td class="actions">
            <a
              class="btn btn-outline btn-sm"
              href="{{ url_for('ubicaciones.editar_ubicacion', ubicacion_id=u.ubicacion_id) }}"
            >
              Editar
            </a>
            <form
              method="post"
              action="{{ url_for('ubicaciones.eliminar_ubicacion', ubicacion_id=u.ubicacion_id) }}"
              class="inline-form"
            >
              <button
                type="submit"
                class="btn btn-outline btn-sm btn-danger"
                onclick="return confirm('¿Eliminar esta ubicación?')"
              >
                Eliminar
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}
</section>
{% endblock %}
